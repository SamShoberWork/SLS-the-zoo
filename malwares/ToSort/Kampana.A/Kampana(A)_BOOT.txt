Kampana 
Aliases:  Anti-Tel, Campana, Drug, Holo, Holocaust, Holokausto, Kampana Boot, Spanish Telecom, Spanish Trojan, Telecom, Telecom PT1, Telefonica, Telephonica  
Infection length:  512 bytes  
Area of infection:  Floppy boot sectors, master boot records  
Likelihood:  Common  
Region reported:  U.S.A., Europe, Russia, Japan  
Characteristics:  Wild, memory resident, stealthing, polymorphic, encrypting, triggered event  
Target platform:  DOS  
Trigger date:  None  
 
Description: 
Kampana is a boot virus that infects the DOS boot sector of floppy disks and the master boot record (MBR) of the first hard drive (80h). The boot virus code is two sectors in length and reserves 1K of memory by modifying the available-memory word at 40:13. Thus, on a 640k machine, CHKDSK would report 654,336 bytes of free memory. 

On the hard drive, the second virus sector and original MBR is stored on physical sectors six and seven of the infected drive. The virus stores the second virus sector and original DOS boot sector in the last two sectors of the root directory. Unlike Stoned, Kampana very methodically calculates the correct sectors for floppy disks ranging from 160K to 1.44 MB. If Kampana is active in memory, the virus sectors and original MBR sectors are all stealthed on the hard drive. Floppy disk sectors are not stealthed. 

Kampana is often classified as multipartite, which means it infects program files and boot sectors. However, this is not strictly correct. Kampana is a stealth virus and does not infect files, but is dropped by a file virus. For example, there is a file virus strain, Kampana.3700, that infects .COM files and drops the Kampana boot sector virus. However, the Kampana boot virus, in turn, does not infect .COM files, as do true multipartite viruses. Moreover, the Kampana file virus is not at all common, while the Kampana boot sector virus is very common. 

Each time an infected hard drive is booted, a counter is incremented. When the counter reaches 401, the virus triggers. The virus then overwrites all sectors on the first and second hard disks with garbage. As each head on each drive is overwritten, the following message (encrypted on the disk and in memory) is displayed: 


Campana Anti-TELEFONICA (Barcelona) 
The original Kampana file virus contains more encrypted text that credits a Grupo Holokausto in Barcelona, Spain with programming the virus, and gives date of 23-8-90 along with a copyright notice. A message in the virus also demands lower phone rates and more service. 

Kampana.3445 has three known strains: 


Kampana.3445 - Drops the Kampana boot virus. 

Kampana.3770 - Uses polymorphic technology and drops the Kampana boot virus. 

Kampana.3784 - Drops the Kampana boot virus. 


